<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="AppConstants.js"></script>
    <script src="apis.js"></script>
    <title>Submit Form</title>
  </head>
  <body>
    <script>
      document.addEventListener("DOMContentLoaded", (event) => {
        const initialValues = {
          SapID: "52110368",
          Title: "PAREME",
          ResourceEmail: "a.parameshwaran@hcltech.om",
          Week1: "2",
          Week2: "47",
          Week3: "43",
          Week4: "12",
          Month: "June",
          Year: "2024",
          ResourceRole: "Onshore",
          ApprovalStatus: "Yes",
          Eur_x002f_Hour: "23",
        };

        document.getElementById("ResourceEmail").value =
          initialValues.ResourceEmail;
        document.getElementById("month").value = initialValues.Month;
        document.getElementById("Title").value = initialValues.Title;
        document.getElementById("SapID").value = initialValues.SapID;
        document.getElementById("year").value = initialValues.Year;
        document.getElementById("Week1").value = initialValues.Week1;
        document.getElementById("Week2").value = initialValues.Week2;
        document.getElementById("Week3").value = initialValues.Week3;
        document.getElementById("Week4").value = initialValues.Week4;
        document.getElementById("EurHour").value = initialValues.Eur_x002f_Hour;
        document.getElementById("ResourceRole").value =
          initialValues.ResourceRole;
        console.log("karthik", typeof initialValues.Month);
      });

      function submitForm(event) {
        event.preventDefault();
        const form = document.getElementById("workHoursForm");

        const data = {
          Title: form.Title.value,
          SapID: form.SapID.value,
          ResourceEmail: form.ResourceEmail.value,
          Month: form.month.value,
          Year: form.year.value,
          Week1: form.Week1.value,
          Week2: form.Week2.value,
          Week3: form.Week3.value,
          Week4: form.Week4.value,
          ResourceRole: form.ResourceRole.value,
          Eur_x002f_Hour: form.EurHour.value,
        };
        
        fetch(
          "https://crm581985.sharepoint.com/sites/ProjectManagerTool/_api/web/lists/getbytitle('effort_tracking')/items",
          {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              Authorization: "Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IkwxS2ZLRklfam5YYndXYzIyeFp4dzFzVUhIMCIsImtpZCI6IkwxS2ZLRklfam5YYndXYzIyeFp4dzFzVUhIMCJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTBmZjEtY2UwMC0wMDAwMDAwMDAwMDAvY3JtNTgxOTg1LnNoYXJlcG9pbnQuY29tQGE4MTk0MjdiLTg2ZDEtNDM2Ni05MjJiLTQxNTBmYjM4YWRiNCIsImlzcyI6IjAwMDAwMDAxLTAwMDAtMDAwMC1jMDAwLTAwMDAwMDAwMDAwMEBhODE5NDI3Yi04NmQxLTQzNjYtOTIyYi00MTUwZmIzOGFkYjQiLCJpYXQiOjE3MTg1OTc1MTMsIm5iZiI6MTcxODU5NzUxMywiZXhwIjoxNzE4Njg0MjEzLCJpZGVudGl0eXByb3ZpZGVyIjoiMDAwMDAwMDEtMDAwMC0wMDAwLWMwMDAtMDAwMDAwMDAwMDAwQGE4MTk0MjdiLTg2ZDEtNDM2Ni05MjJiLTQxNTBmYjM4YWRiNCIsIm5hbWVpZCI6ImNjNjFiZDcyLTE0MTMtNDIwNi1iODcxLTM0OWMyODk4NGRjNEBhODE5NDI3Yi04NmQxLTQzNjYtOTIyYi00MTUwZmIzOGFkYjQiLCJvaWQiOiI3OWRjYjlmYy00NWY2LTQxMWMtYWRmNS1jZWVlNTBjNTgzMjciLCJzdWIiOiI3OWRjYjlmYy00NWY2LTQxMWMtYWRmNS1jZWVlNTBjNTgzMjciLCJ0cnVzdGVkZm9yZGVsZWdhdGlvbiI6ImZhbHNlIn0.Bfif7E-NA6W4qFzZd9IAUlo1HL6OlPFHDS4uVhliukMZZJFa_ENESvEPFn3BMyDBPKv1TVBHS1Gf7yoEngvVAsmSy4JCErapWNsz_zNnT8EHOFAbZ-pkcKDeJG5SLThNY6P0XWIdXTWoSrlUz5Ginou0PJDCpvczOGwZeocP8VzONnklNr3md8cXzE5xdGk45g15kej92DR16pgXtlkK06ZhkHk159Jbmx6VDawsWHCdTqiJO2rPjn8tdbOODYM1MWyAORbKzQ7MvIHvuwZI47rglekmPVTAdwAlsoGG7_nw7t6wbJFAbZ0V6kxkF7-dPFCDHXlfV_B3l1Rcu2v1og",
            },
            body: JSON.stringify(data),
          }
        )
          .then((response) => response.json())
          .then((data) => {
            console.log("Success:", data);
          })
          .catch((error) => {
            console.error("Error:", error);
          });
      }
    </script>
  </head>
  <body>
    <form id="workHoursForm" onsubmit="submitForm(event)">
      <label for="Title">Resource Name:</label>
      <input type="text" id="Title" name="Title" required /><br /><br />

      <label for="SapID">Resource Sap Id:</label>
      <input type="text" id="SapID" name="SapID" required /><br /><br />

      <label for="EurHour">Resource Eur/Hour:</label>
      <input type="text" id="EurHour" name="EurHour" required /><br /><br />

      <label for="resourceEmail">Resource Email:</label>
      <input
        type="email"
        id="ResourceEmail"
        name="ResourceEmail"
        required
      /><br /><br />

      <label for="month">Month:</label>
      <select id="month" name="month" required>
        <option value="">Select Month</option>
        <option value="January">January</option>
        <option value="February">February</option>
        <option value="March">March</option>
        <option value="April">April</option>
        <option value="May">May</option>
        <option value="June">June</option>
        <option value="July">July</option>
        <option value="August">August</option>
        <option value="September">September</option>
        <option value="October">October</option>
        <option value="November">November</option>
        <option value="December">December</option></select
      ><br /><br />

      <label for="year">Year:</label>
      <select id="year" name="year" required>
        <option value="">Select Year</option>
        <option value="2022">2022</option>
        <option value="2023">2023</option>
        <option value="2024">2024</option></select
      ><br /><br />

      <label for="Week1">Week1 Work Hours:</label>
      <input type="number" id="Week1" name="Week1" required /><br /><br />

      <label for="Week2">Week2 Work Hours:</label>
      <input type="number" id="Week2" name="Week2" required /><br /><br />

      <label for="Week3">Week3 Work Hours:</label>
      <input type="number" id="Week3" name="Week3" required /><br /><br />

      <label for="Week4">Week4 Work Hours:</label>
      <input type="number" id="Week4" name="Week4" required /><br /><br />

      <label for="ResourceRole">Select Shore:</label>
      <select id="ResourceRole" name="ResourceRole" required>
        <option value="Onshore">OnShore</option>
        <option value="OffShore">OffShore</option></select
      ><br /><br />

      <button type="submit">Submit</button>
    </form>
  </body>
</html>
